<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Tu carta ðŸ’Œ</title>

<meta property="og:title" content="ðŸ’Œ Toca para abrir tu carta">
<meta property="og:description" content="Abre el sobre, de: Abril">
<meta property="og:image" content="envelope.jpg">

<style>
  :root{
    --bg:#fff4f6;           /* si prefieres beige: #f7e8d0 */
    --ink:#111;
    --shadow:rgba(0,0,0,.18);
    --radius:18px;

    --shake: 1.35s;
    --blast: 0.70s;
    --after: calc(var(--shake) + var(--blast) + .05s);
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html,body{
    height:100%;
    background:var(--bg);
    color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
  }

  /* estructura centrada: tÃ­tulo arriba, sobre centrado */
  .wrap{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    text-align:center;
    gap:1.4rem;
    padding-top:3rem; /* separa el tÃ­tulo */
  }

  h1{
    font-size:clamp(22px,4.5vw,34px);
    margin-bottom:.5rem;
  }

  .stage{
    position:relative;
    width:min(480px,94vw);
    aspect-ratio:16/10;
    overflow:visible;
  }

  /* sobre sin bordes blancos */
  .envelope{
    position:absolute;inset:0;display:block;cursor:pointer;z-index:3;
    background:transparent;box-shadow:none;border-radius:0;overflow:hidden;
    transform-origin:50% 30%;
  }
  .envelope img{
    width:100%;height:100%;object-fit:contain;display:block;background:transparent;
  }

  /* âœ¨ estrellitas */
  .stars{
    position:absolute;inset:0;
    pointer-events:none;
    z-index:6;
    overflow:visible;
  }
  .star{
    position:absolute;
    width:6px;height:6px;
    background: radial-gradient(circle, #fff 0%, #ffd6f0 60%, transparent 100%);
    border-radius:50%;
    opacity:0;
    transform:scale(0.3);
    animation: twinkle 1s ease-out forwards;
  }

  @keyframes twinkle{
    0%{opacity:0;transform:scale(0.3)}
    20%{opacity:1;transform:scale(1)}
    70%{opacity:1;transform:scale(1)}
    100%{opacity:0;transform:translateY(-40px) scale(0.8)}
  }

  /* carta completa */
  .letter-full{
    position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
    padding:14px;z-index:-1;opacity:0;background:var(--bg);
    transition:opacity .45s ease var(--after), z-index 0s linear var(--after);
  }
  .letter-full img{
    max-width:min(92vw,760px);
    max-height:92vh;
    width:auto;height:auto;object-fit:contain;display:block;background:#fff;border-radius:16px;
    box-shadow:0 18px 40px var(--shadow);
  }

  body.open .letter-full{ z-index:5; opacity:1; transition:opacity .45s ease var(--after), z-index 0s }

  /* animaciones del sobre */
  body.open .envelope{
    animation:
      shake var(--shake) ease-in-out both,
      blast var(--blast) cubic-bezier(.25,.7,.2,1) var(--shake) both;
    pointer-events:none;
  }

  @keyframes shake{
    0%{transform:translate(0,0) rotate(0deg)}
    5%{transform:translate(-6px,2px) rotate(-5deg)}
    15%{transform:translate(6px,-3px) rotate(4deg)}
    25%{transform:translate(-8px,3px) rotate(-6deg)}
    35%{transform:translate(8px,-4px) rotate(5deg)}
    50%{transform:translate(-6px,2px) rotate(-4deg)}
    65%{transform:translate(5px,-2px) rotate(3deg)}
    80%{transform:translate(-4px,1px) rotate(-2deg)}
    100%{transform:translate(0,0) rotate(0deg)}
  }

  @keyframes blast{
    0%  {opacity:1; transform:scale(1) rotateX(0deg)}
    30% {transform:scale(1.10) rotateX(10deg)}
    60% {transform:scale(1.25) rotateX(16deg) filter:blur(2px)}
    100%{opacity:0; transform:scale(1.35) rotateX(22deg) filter:blur(8px)}
  }

  @media (prefers-reduced-motion: reduce){
    .envelope, .letter-full, .stars, .star{transition:none;animation:none}
    body.open .letter-full{opacity:1;z-index:5}
  }
</style>
</head>
<body>
  <div class="wrap">
    <h1>ðŸ’Œ Toca para abrir tu carta</h1>

    <div class="stage">
      <!-- sobre -->
      <a class="envelope" id="btnEnvelope" aria-label="Abrir carta">
        <img id="imgEnvelope" src="envelope.jpg" alt="Sobre">
      </a>

      <!-- capa de estrellitas -->
      <div class="stars" id="stars"></div>
    </div>

    <!-- carta -->
    <div class="letter-full" id="overlay">
      <a id="openImg" href="carta.jpg" target="_blank" rel="noopener">
        <img id="imgCarta" src="carta.jpg" alt="Carta">
      </a>
    </div>
  </div>

<script>
  // cargar imÃ¡genes opcionales (?cover & ?img)
  const qp = new URLSearchParams(location.search);
  const cover = qp.get('cover');
  const img   = qp.get('img');
  if (cover) document.getElementById('imgEnvelope').src = cover;
  if (img){
    document.getElementById('imgCarta').src = img;
    document.getElementById('openImg').href = img;
  }

  // generar estrellitas al abrir
  const starsContainer = document.getElementById('stars');
  function spawnStars(){
    for(let i=0;i<12;i++){
      const s = document.createElement('div');
      s.className = 'star';
      const x = Math.random()*100;
      const y = Math.random()*100;
      const delay = (Math.random()*0.5)+'s';
      s.style.left = x+'%';
      s.style.top = y+'%';
      s.style.animationDelay = delay;
      starsContainer.appendChild(s);
      setTimeout(()=>s.remove(),1500); // se limpian
    }
  }

  // click => abre
  document.getElementById('btnEnvelope').addEventListener('click', (e)=>{
    e.preventDefault();
    document.body.classList.add('open');
    setTimeout(spawnStars, (parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--shake'))*1000));
  }, {passive:true});

  // autoabrir si ?auto=1
  if (qp.get('auto') === '1'){
    setTimeout(()=>{
      document.body.classList.add('open');
      setTimeout(spawnStars, (parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--shake'))*1000));
    }, 180);
  }
</script>
</body>
</html>
